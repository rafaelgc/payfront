# Payfront

This web application is designed for property owners who want to collect rental
payments through direct debit (SEPA direct debits).

The platform simplifies the process of managing rental payments by acting as a
wrapper around Stripe. It eliminates the need to deal with complex payment
system setups, offering a straightforward and user-friendly solution.

In addition to handling recurring payments, the application also supports
one-off payments, making it ideal for collecting additional charges, such as
utility costs.

## Tech Stack

- TypeScript
- NextJS
- Material UI
- Stripe SDK
- Jest
- AWS (ECS / EC2)

## Installation (development)

### Prerequisites

- Docker
- Docker Compose
- Stripe account
- Ngrok account

### Steps

1. **Download the repository:**

```
git clone https://github.com/rafaelgc/payfront.git
cd payfront
```

2. **Create your .env file:**

```
cp .env.example .env
vi .env
```

3. **Start the services:**

```
docker-compose up
```

This command will start the two required services:

- The web application itself.
- An Ngrok instance to enable Stripe communication with the local application.

4. **Set up Stripe Hooks**

    1. Go to http://localhost:4040 and get the public URL generated by Ngrok.
    2. Go to your Stripe account and create a webhook with the following settings:
        - URL: https://your-ngrok-url/api/whook
        - Events: `invoice.created` and `invoice.payment_succeeded`

5. **Access the application**

Go to http://localhost:3000 in your browser.

## Tests

To run the tests:
```
docker-compose exec payfront npm test
```

## Build for Production

This script builds a production-ready image and uploads it to a private
Elastic Container Registry:

```
sh build-and-push.sh
```